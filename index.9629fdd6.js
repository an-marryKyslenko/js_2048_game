const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=t,this.copeInitialState=t.map(t=>[...t]),this.status="idle",this.score=0}moveLeft(){if("playing"===this.status){let t=this.initialState.map(t=>[...t]);for(let t=0;t<4;t++){let i=[];for(let e=0;e<4;e++)0!==this.initialState[t][e]&&i.push(this.initialState[t][e]);this.merchCails(i);for(let e=0;e<4;e++)this.initialState[t][e]=i[e]||0}this.canMove(t,this.initialState)&&this.randomCail()}}moveRight(){if("playing"===this.status){let t=this.initialState.map(t=>[...t]);for(let t=0;t<4;t++){let i=[];for(let e=3;e>=0;e--)0!==this.initialState[t][e]&&i.push(this.initialState[t][e]);this.merchCails(i);let e=0;for(let a=3;a>=0;a--)this.initialState[t][a]=i[e]||0,e++}this.canMove(t,this.initialState)&&this.randomCail()}}moveUp(){if("playing"===this.status){let t=this.initialState.map(t=>[...t]);for(let t=0;t<4;t++){let i=[];for(let e=0;e<4;e++)0!==this.initialState[e][t]&&i.push(this.initialState[e][t]);this.merchCails(i);for(let e=0;e<4;e++)this.initialState[e][t]=i[e]||0}this.canMove(t,this.initialState)&&this.randomCail()}}moveDown(){if("playing"===this.status){let t=this.initialState.map(t=>[...t]);for(let t=0;t<4;t++){let i=[];for(let e=3;e>=0;e--)0!==this.initialState[e][t]&&i.push(this.initialState[e][t]);this.merchCails(i);let e=0;for(let a=3;a>=0;a--)this.initialState[a][t]=i[e]||0,e++}this.canMove(t,this.initialState)&&this.randomCail()}}getScore(){return this.score}getState(){return this.initialState}getStatus(){return this.checkGameOver(this.initialState)&&(this.status="lose"),this.status}start(){this.status="playing";let t=0;for(;t<2;)this.randomCail(),t++}restart(){this.status="idle",this.score=0,this.initialState=this.copeInitialState}randomCail(){let t=this.initialState.some(t=>t.includes(0)),i=.1>Math.random()?4:2,e=this.initialState.length;if(t)for(;;){let t=Math.floor(Math.random()*e),a=Math.floor(Math.random()*e);if(0===this.initialState[t][a]){this.initialState[t][a]=i;break}}else this.status="lose"}canMove(t,i){for(let e=0;e<this.initialState.length;e++)for(let a=0;a<this.initialState.length;a++)if(t[e][a]!==i[e][a])return!0;return!1}checkGameOver(t){for(let i=0;i<this.initialState.length;i++)for(let e=0;e<this.initialState.length;e++)if(0===t[i][e])return!1;for(let i=0;i<this.initialState.length;i++)for(let e=0;e<this.initialState.length;e++)if(e<this.initialState.length-1&&t[i][e]===t[i][e+1]||i<this.initialState.length-1&&t[i][e]===t[i+1][e])return!1;return!0}merchCails(t){for(let i=0;i<t.length-1;i++)t[i]===t[i+1]&&t[i]&&(t[i]*=2,this.score+=t[i],2048===t[i]&&(this.status="win"),t.splice(i+1,1))}};document.addEventListener("DOMContentLoaded",()=>{let i=document.querySelector(".game-score"),e=document.querySelector(".start"),a=document.querySelectorAll(".field-row");function s(){let i=t.getState();for(let t=0;t<i.length;t++){let e=a[t].querySelectorAll(".field-cell");for(let a=0;a<e.length;a++){let s=i[t][a];!function(t){t.className.split(" ").forEach(i=>{/^field-cell--\d+$/.test(i)&&t.classList.remove(i)})}(e[a]),0!==s?(e[a].classList.add(`field-cell--${s}`),e[a].innerText=s):e[a].innerText=""}}}e.addEventListener("click",()=>{let i=document.querySelector(".message-start");"idle"===t.getStatus()?t.start():(t.restart(),location.reload()),i.classList.add("hidden"),e.classList.remove("start"),e.classList.add("restart"),e.innerText="Restart",s()}),document.addEventListener("keydown",e=>{var a;switch(e.preventDefault(),e.key){case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight()}s(),i.innerText=t.getScore(),("win"===(a=t.getStatus())||"lose"===a)&&document.querySelector(`.message-${a}`).classList.remove("hidden")})});
//# sourceMappingURL=index.9629fdd6.js.map

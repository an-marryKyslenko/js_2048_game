!function(){function t(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,a=Array(i);e<i;e++)a[e]=t[e];return a}function i(i){return function(i){if(Array.isArray(i))return t(i)}(i)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(i,e){if(i){if("string"==typeof i)return t(i,void 0);var a=Object.prototype.toString.call(i).slice(8,-1);if("Object"===a&&i.constructor&&(a=i.constructor.name),"Map"===a||"Set"===a)return Array.from(a);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(i,void 0)}}(i)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var e=new(function(){var t;function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(t,i){if(!(t instanceof i))throw TypeError("Cannot call a class as a function")}(this,e),this.initialState=t,this.copeInitialState=t.map(function(t){return i(t)}),this.status="idle",this.score=0}return t=[{key:"moveLeft",value:function(){if("playing"===this.status){for(var t=this.initialState.map(function(t){return i(t)}),e=0;e<4;e++){for(var a=[],n=0;n<4;n++)0!==this.initialState[e][n]&&a.push(this.initialState[e][n]);this.merchCails(a);for(var r=0;r<4;r++)this.initialState[e][r]=a[r]||0}this.canMove(t,this.initialState)&&this.randomCail()}}},{key:"moveRight",value:function(){if("playing"===this.status){for(var t=this.initialState.map(function(t){return i(t)}),e=0;e<4;e++){for(var a=[],n=3;n>=0;n--)0!==this.initialState[e][n]&&a.push(this.initialState[e][n]);this.merchCails(a);for(var r=0,o=3;o>=0;o--)this.initialState[e][o]=a[r]||0,r++}this.canMove(t,this.initialState)&&this.randomCail()}}},{key:"moveUp",value:function(){if("playing"===this.status){for(var t=this.initialState.map(function(t){return i(t)}),e=0;e<4;e++){for(var a=[],n=0;n<4;n++)0!==this.initialState[n][e]&&a.push(this.initialState[n][e]);this.merchCails(a);for(var r=0;r<4;r++)this.initialState[r][e]=a[r]||0}this.canMove(t,this.initialState)&&this.randomCail()}}},{key:"moveDown",value:function(){if("playing"===this.status){for(var t=this.initialState.map(function(t){return i(t)}),e=0;e<4;e++){for(var a=[],n=3;n>=0;n--)0!==this.initialState[n][e]&&a.push(this.initialState[n][e]);this.merchCails(a);for(var r=0,o=3;o>=0;o--)this.initialState[o][e]=a[r]||0,r++}this.canMove(t,this.initialState)&&this.randomCail()}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.initialState}},{key:"getStatus",value:function(){return this.checkGameOver(this.initialState)&&(this.status="lose"),this.status}},{key:"start",value:function(){this.status="playing";for(var t=0;t<2;)this.randomCail(),t++}},{key:"restart",value:function(){this.status="idle",this.score=0,this.initialState=this.copeInitialState}},{key:"randomCail",value:function(){var t=this.initialState.some(function(t){return t.includes(0)}),i=.1>Math.random()?4:2,e=this.initialState.length;if(t)for(;;){var a=Math.floor(Math.random()*e),n=Math.floor(Math.random()*e);if(0===this.initialState[a][n]){this.initialState[a][n]=i;break}}else this.status="lose"}},{key:"canMove",value:function(t,i){for(var e=0;e<this.initialState.length;e++)for(var a=0;a<this.initialState.length;a++)if(t[e][a]!==i[e][a])return!0;return!1}},{key:"checkGameOver",value:function(t){for(var i=0;i<this.initialState.length;i++)for(var e=0;e<this.initialState.length;e++)if(0===t[i][e])return!1;for(var a=0;a<this.initialState.length;a++)for(var n=0;n<this.initialState.length;n++)if(n<this.initialState.length-1&&t[a][n]===t[a][n+1]||a<this.initialState.length-1&&t[a][n]===t[a+1][n])return!1;return!0}},{key:"merchCails",value:function(t){for(var i=0;i<t.length-1;i++)t[i]===t[i+1]&&t[i]&&(t[i]*=2,this.score+=t[i],2048===t[i]&&(this.status="win"),t.splice(i+1,1))}}],function(t,i){for(var e=0;e<i.length;e++){var a=i[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}(e.prototype,t),e}());document.addEventListener("DOMContentLoaded",function(){var t=function(t){t.className.split(" ").forEach(function(i){/^field-cell--\d+$/.test(i)&&t.classList.remove(i)})},i=function(t){("win"===t||"lose"===t)&&document.querySelector(".message-".concat(t)).classList.remove("hidden")},a=function(){for(var i=e.getState(),a=0;a<i.length;a++)for(var n=o[a].querySelectorAll(".field-cell"),r=0;r<n.length;r++){var s=i[a][r];t(n[r]),0!==s?(n[r].classList.add("field-cell--".concat(s)),n[r].innerText=s):n[r].innerText=""}},n=document.querySelector(".game-score"),r=document.querySelector(".start"),o=document.querySelectorAll(".field-row");r.addEventListener("click",function(){var t=document.querySelector(".message-start");"idle"===e.getStatus()?e.start():(e.restart(),location.reload()),t.classList.add("hidden"),r.classList.remove("start"),r.classList.add("restart"),r.innerText="Restart",a()}),document.addEventListener("keydown",function(t){switch(t.preventDefault(),t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight()}a(),n.innerText=e.getScore(),i(e.getStatus())})})}();
//# sourceMappingURL=index.a8e0dd03.js.map
